# Troubleshooting Guide

## Проблема: Порт занят (Port already in use)

### Симптомы:
```
RuntimeError: Failed to bind to address 0.0.0.0:8080
```

### Решение:

1. **Остановить все процессы Flower:**
   ```bash
   scripts\stop_all_flower.bat
   ```

2. **Или вручную найти и остановить процесс:**
   ```bash
   # Найти процесс на порту 8080
   netstat -ano | findstr :8080
   
   # Остановить процесс (замените PID на найденный)
   taskkill /F /PID <PID>
   ```

3. **Проверить доступность портов:**
   ```bash
   python scripts\check_ports.py
   ```

## Проблема: Адрес 0.0.0.0 не работает на Windows

### Симптомы:
```
Failed to add port to server: No address added out of total 1 resolved for '0.0.0.0:8080'
```

### Решение:

Используйте `127.0.0.1` вместо `0.0.0.0`:

```bash
set SERVER_ADDRESS=127.0.0.1
python flower_server\server_with_monitoring.py
```

Или в коде уже исправлено - используйте переменную окружения:
```bash
set SERVER_ADDRESS=127.0.0.1
```

## Проблема: Клиент не подключается к серверу

### Решение:

1. Убедитесь, что сервер запущен:
   ```bash
   # Проверить статус сервера
   curl http://localhost:8082/health
   ```

2. Проверьте адрес сервера в клиенте:
   ```bash
   python flower_client\client_with_api.py --server-address 127.0.0.1:8080
   ```

3. Убедитесь, что используется тот же адрес (127.0.0.1, а не localhost или 0.0.0.0)

## Проблема: HTTP API не отвечает

### Решение:

1. Подождите несколько секунд после запуска (инициализация данных)
2. Проверьте логи в окнах сервера/клиента
3. Убедитесь, что порты не заняты:
   ```bash
   python scripts\check_ports.py
   ```

## Проблема: Обучение не начинается

### Решение:

1. Убедитесь, что все 3 клиента подключены к серверу
2. Проверьте минимальное количество клиентов в настройках:
   ```bash
   set MIN_CLIENTS=1  # Для тестирования с одним клиентом
   ```

3. Проверьте логи сервера - он должен ждать подключения клиентов

## Проблема: Модель не сохраняется

### Решение:

1. Проверьте права доступа к директории `models/`
2. Убедитесь, что директория существует
3. Проверьте логи сервера на наличие ошибок сохранения

## Общие рекомендации

1. **Всегда используйте `127.0.0.1` вместо `0.0.0.0` на Windows**
2. **Проверяйте доступность портов перед запуском**
3. **Используйте скрипты для остановки процессов перед новым запуском**
4. **Проверяйте логи в окнах сервера и клиентов**

## Полезные команды

```bash
# Проверить порты
python scripts\check_ports.py

# Остановить все процессы
scripts\stop_all_flower.bat

# Проверить статус мониторинга
python scripts\quick_monitoring_test.py

# Найти процесс на порту
netstat -ano | findstr :8080
```

